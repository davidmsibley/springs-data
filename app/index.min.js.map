{"version":3,"file":"index.min.js","sources":["../../app/restyling-circle-marker.js","../../app/site-data.js","../../app/index.js","../../app/site-map.js","../../app/site-router.js"],"sourcesContent":["\nconst colorRange = [\n  '#e0ecf4',\n  '#bfd3e6',\n  '#9ebcda',\n  '#8c96c6',\n  '#8c6bb1',\n  '#88419d',\n  '#810f7c'\n];\nconst calcRadius = (a) => Math.max(a/1.5,3);\nexport const RestylingCircleMarker = L.CircleMarker.extend({ \n  getEvents: function() {\n    return {\n      zoomend: this._restyle,\n      normalpoints: this._normal,\n      typepoints: this._orifice,\n      condpoints: this._conductivity,\n      qpoints: this._discharge\n    }\n  },\n  _restyle: function(e) {\n    this.setRadius(calcRadius(e.target.getZoom()))\n  },\n  _normal: function(e) {\n    let color = '#3388ff';\n    if (!this._activeBackup) {\n      this.setStyle({'color': color});\n    } else {\n      this._activeBackup = color;\n    }\n  },\n  _orifice: function(e) {\n    var color = '#3388ff';\n    if (this.feature.properties.Orifice_Geom === 'seepage/filtration') {\n      color = '#33AA44';\n    }\n    if (!this._activeBackup) {\n      this.setStyle({'color': color});\n    } else {\n      this._activeBackup = color;\n    }\n  },\n  _conductivity: function(e) {\n    var color = colorRange[colorRange.length-1];\n    var binWidth = (aggrData.aggr['Conductivity_uS'].max - aggrData.aggr['Conductivity_uS'].min) / colorRange.length;\n    for (var i = 1; i < colorRange.length; i++) {\n      if (((binWidth * i) + aggrData.aggr['Conductivity_uS'].min) > this.feature.properties['Conductivity_uS']) {\n        color = colorRange[i];\n        break;\n      }\n    }\n    if (!this._activeBackup) {\n      this.setStyle({'color': color});\n    } else {\n      this._activeBackup = color;\n    }\n  },\n  _discharge: function(e) {\n    var color = colorRange[colorRange.length-1];\n    var binWidth = (aggrData.aggr['Discharge_cfs'].max - aggrData.aggr['Discharge_cfs'].min) / colorRange.length;\n    for (var i = 1; i < colorRange.length; i++) {\n      if (((binWidth * i) + aggrData.aggr['Discharge_cfs'].min) > this.feature.properties['Discharge_cfs']) {\n        color = colorRange[i];\n        break;\n      }\n    }\n    if (!this._activeBackup) {\n      this.setStyle({'color': color});\n    } else {\n      this._activeBackup = color;\n    }\n  },\n  highlight: function() {\n    this._activeBackup = this.options.color;\n    this.setStyle({'color': 'orange'})\n  },\n  removeHighlight: function() {\n    if (this._activeBackup) {\n      this.setStyle({'color': this._activeBackup})\n      this._activeBackup = null;\n    }\n  }\n\n});","\nexport class SiteData {\n  constructor(springs, springPhotos, springSketches) {\n    this._springPhotos = springPhotos;\n    this._springSketches = springSketches;\n\n    // Define aggregated data for visualization\n    this._aggrKeys = ['Site_Code', 'Conductivity_uS', 'Discharge_cfs', 'pH', 'Water_Temp_C'];\n\n    this.aggrData = SiteData._gatherAggrData(springs, this._aggrKeys);\n  }\n\n  async lookupPhotos(site) {\n    const springPhotos = this._springPhotos;\n    return new Promise(function(resolve, reject) {\n      springPhotos.query().where(\"Site_Code = '\" + site + \"'\").run(function(err, col) {\n        if (!err) {\n          var photos = col.features.map( function(value) { return value.properties; } );\n          photos.sort(function(a, b) {\n            return a.Image_Number - b.Image_Number;\n          });\n\n          resolve(photos);\n        } else {\n          // console.log('Could not get Spring Photos', err);\n          reject(err);\n        }\n      });\n    });\n  }\n\n  async lookupSketches(site) {\n    const springSketches = this._springSketches;\n    return new Promise(function(resolve, reject) {\n      springSketches.query().where(\"File_Prefix = '\" + site + \"'\").run(function(err, col) {\n        if (!err) {\n          var sketches = col.features.map( function(value, index) { return value.properties['FileURL']});\n          resolve(sketches);\n        } else {\n          // console.log('Could not get Spring Sketches', err);\n          reject(err);\n        }\n      });\n    });\n  }\n\n  static _gatherAggrData(layer, aggrKeys) {\n    const aggrData = {\n      aggr: {},\n      data: []\n    };\n\n    // Collect datasets and aggregates\n    layer.eachFeature(function(obj, l) {\n      let result = {};\n      aggrKeys.forEach(function(key) {\n        result[key] = obj.feature.properties[key]\n        if (!aggrData.aggr[key]) {\n          aggrData.aggr[key] = {};\n        }\n        if (result[key] && 'number' === typeof result[key]) {\n          if (!aggrData.aggr[key].max || aggrData.aggr[key].max < result[key]) {\n            aggrData.aggr[key].max = result[key];\n          }\n          if (!aggrData.aggr[key].min || aggrData.aggr[key].min > result[key]) {\n            aggrData.aggr[key].min = result[key];\n          }\n        }\n      });\n      aggrData.data.push(result);\n    });\n\n    return aggrData;\n  }\n}","import { SiteMap } from './site-map.js';\nimport { SiteData } from './site-data.js';\nimport { SiteRouter } from './site-router.js';\n\nwindow.siteMap = new SiteMap();\nwindow.sidebar = document.querySelector('#sidebar');\n\nwindow.siteMap.once('init', function() {\n  window.siteData = new SiteData(window.siteMap.springs, window.siteMap.springPhotos, window.siteMap.springSketches);\n  window.aggrData = siteData.aggrData;\n\n  var deselectFeature = function() {\n    document.dispatchEvent(new CustomEvent('toggle-sketch', {bubbles: true, detail: {closed: true}}));\n    document.querySelectorAll('site-details').forEach(function(details) {\n      details['siteinfo'] = null;\n      details['photos'] = null;\n    });\n    document.querySelectorAll('site-sketch').forEach(function(sketch) {\n      sketch['pdfsrc'] = null;\n    });\n  }\n\n  var selectFeature = function(info) {\n    deselectFeature();\n    return Promise.all([\n      window.siteData.lookupPhotos(info['Site_Code']).catch(()=>[]), \n      window.siteData.lookupSketches(info['Site_Code']).catch(()=>[])\n    ]).then(function(resolved) {\n      // console.log('loaded site photos and sketches');\n      document.querySelectorAll('site-details').forEach(function(details) {\n        details['siteinfo'] = info;\n        details['photos'] = resolved[0];\n      });\n      if (resolved[1]) {\n        document.querySelectorAll('site-sketch').forEach(function(sketch) {\n          sketch['pdfsrc'] = resolved[1][0];\n        })\n      }\n    })\n  };\n\n  window.router = new SiteRouter();\n  window.router.on('route-entry', () => {\n    // console.log('route-entry');\n    window.siteMap.clearSelection();\n    deselectFeature();\n    document.querySelector('#app').setAttribute('data-view', 'app');\n    window.sidebar.switchTab('default');\n    window.siteMap.setVisibility(true);\n  });\n  window.router.on('route-view', (params) => {\n    // console.log('route-view');\n    let attr = window.siteMap.selectPoint(params['Site_Code']);\n    document.querySelectorAll('site-details').forEach(function(details) {\n      details['printLayout'] = false;\n    });\n    selectFeature(attr).then(() => {\n      document.querySelector('#app').setAttribute('data-view', 'app');\n      window.sidebar.switchTab('details');\n      window.siteMap.setVisibility(true);\n    })\n  });\n  window.router.on('route-print', (params) => {\n    // console.log('route-print');\n    let attr = window.siteMap.selectPoint(params['Site_Code']);\n    document.querySelectorAll('site-details').forEach(function(details) {\n      details['printLayout'] = true;\n    });\n    selectFeature(attr).then(() => {\n      document.querySelector('#app').removeAttribute('data-view');\n      window.sidebar.switchTab('details');\n      window.siteMap.setVisibility(false);\n    })\n  });\n  window.router.resolve();\n\n  window.siteMap.on('interaction', (params) => {\n    if (params['Site_Code']) {\n      window.router.setRoute('view', params);\n    } else {\n      window.router.clearRoute();\n    }\n  });\n});\ndocument.addEventListener('clear-selection', function(e) {\n  window.router.clearRoute();\n});\n\n\ndocument.addEventListener('toggle-print', function(e) {\n  if (e.detail.on) {\n    window.router.setRoute('print', e.detail.params);\n  } else {\n    window.router.setRoute('view', e.detail.params);\n  }\n});\n\ndocument.addEventListener('toggle-sketch', function(e) {\n  window.siteMap.setVisibility(e.detail.closed);\n});\n\n\ndocument.addEventListener('stylepoints', function(e) {\n  if (e.detail.type) {\n    window.siteMap.map.fire(e.detail.type + 'points');\n  }\n});","import { RestylingCircleMarker } from './restyling-circle-marker.js';\n\nexport class SiteMap extends window.L.Evented {\n  constructor() {\n    super();\n    this.selected = false;\n\n    /* ~~~~~~~~ Map ~~~~~~~~ */\n    //create a map, center it, and set the zoom level. \n    //set zoomcontrol to false because we will add it in a different corner. \n    const map = this.map = L.map('map', {zoomControl:false}).setView([45, -89.623861], 6);\n    this.el = document.querySelector('#map');\n     \n     /* ~~~~~~~~ Zoom Control ~~~~~~~~ */\n    //place a zoom control in the top right: \n    new L.Control.Zoom({position: 'topright'}).addTo(map);\n\n     \n    /* ~~~~~~~~ Basemap Layers ~~~~~~~~ */\n     \n    // basemaps from Open Street Map\n    const osmhot = L.tileLayer('https://{s}.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png', {\n      attribution: '&copy; <a href=\"https://osm.org/copyright\">OpenStreetMap</a> contributors', \n       label: \"OpenStreetMap Humanitarian\"\n    }).addTo(map);\n     \n     const osmmapnik =  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n          maxZoom: 19,\n          attribution: '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors', \n          label: \"OpenStreetMap Mapnik\"   \n     }); \n    \n    // Esri basemaps \n    const esrisat = L.esri.basemapLayer('Imagery', {label: \"Esri Satellite\"});\n   \n    const esritopo = L.esri.basemapLayer('Topographic', {label: \"Esri Topographic\"}); \n     \n    // add the basemap control to the map  \n    var basemaps = [osmhot, esrisat]; \n    map.addControl(L.control.basemaps({\n       basemaps: basemaps, \n       tileX: 0, \n       tileY: 0, \n       tileZ: 1\n\n    })); \n\n\n    /* +++++++++++ Springs layer +++++++++++ */ \n    this.springs = L.esri.featureLayer({\n      url: \"https://data.wgnhs.wisc.edu/arcgis/rest/services/springs/springs_inventory/MapServer/1\",\n      pointToLayer: function(geoJsonPoint, latlon) {\n        let color = '#3388ff';\n        return new RestylingCircleMarker(latlon, {\n          weight: 2,\n          radius: 4,\n          color: color\n        });\n      }\n    }).once('load', (function() {\n      this.fire('init');\n    }).bind(this)\n    ).on('click', (function(e) {\n      if (this._highlight !== e.propagatedFrom) {\n        this.fire('interaction', e.propagatedFrom.feature.properties);\n      } else {\n        this.fire('interaction');\n      }\n    }).bind(this)\n    ).addTo(map);\n\n    this._highlight = null;\n\n    /**\n     * Set up data layers for querying\n     */\n    this.springPhotos = L.esri.featureLayer({\n      url: \"https://data.wgnhs.wisc.edu/arcgis/rest/services/springs/springs_inventory/MapServer/6\"\n    });\n    this.springSketches = L.esri.featureLayer({\n      url: \"https://data.wgnhs.wisc.edu/arcgis/rest/services/springs/springs_inventory/MapServer/4\"\n    });\n  }\n\n  getPoint(site) {\n    let result;\n    this.springs.eachFeature(function(obj) {\n      if (obj.feature.properties['Site_Code'] === site) {\n        result = obj;\n      }\n    });\n    return result;\n  }\n\n  zoomToPoint(site) {\n    let point = this.getPoint(site);\n    if (point) {\n      this.map.setZoomAround(point.getLatLng(), 15);\n    }\n  }\n\n  getHighlightPoint() {\n    // console.log('retrieve highlight point');\n    let result = this._highlight;\n    return result;\n  }\n\n  setHighlightPoint(point) {\n    if (point) {\n      // console.log('set highlight point');\n      this._highlight = point;\n      this._highlight.bringToFront()\n      this._highlight.highlight();\n    } else {\n      this.clearSelection();\n    }\n  }\n\n  selectPoint(site) {\n    // console.log('select point on map:', site);\n    let point = this.getPoint(site);\n    let highlightPoint = this.getHighlightPoint();\n    if (point !== highlightPoint) {\n      this.clearSelection();\n      this.setHighlightPoint(point);\n    }\n    return point.feature.properties;\n  }\n\n  clearSelection() {\n    // console.log('clear highlight group');\n    if (this._highlight) {\n      this._highlight.bringToBack();\n      this._highlight.removeHighlight();\n    }\n    this._highlight = null;\n  }\n\n  setVisibility(isVisible) {\n    if (isVisible) {\n      this.el.removeAttribute('data-closed');\n      this.map.invalidateSize();\n    } else {\n      this.el.setAttribute('data-closed', true);\n    }\n  }\n\n\n}","\nexport class SiteRouter extends window.L.Evented {\n\n  constructor() {\n    super();\n    let router = this.router = new Navigo(window.location.origin + '/springs-data/');\n    Object.entries(this.route).forEach(function(el) {\n      if (el[1].signature) {\n        router.on(el[1].signature, el[1].handler);\n      } else {\n        router.notFound(el[1].handler);\n      }\n    });\n  }\n\n  resolve() {\n    this.router.resolve();\n  }\n\n  get route() {\n    return {\n      'entry': {\n        handler: this._entryRoute.bind(this)\n      },\n      'view': {\n        signature: '/view/:Site_Code',\n        handler: this._viewSite.bind(this)\n      },\n      'print': {\n        signature: '/print/:Site_Code',\n        handler: this._printSite.bind(this)\n      }\n    };\n  }\n\n  _updateLocation(path) {\n    this.router.pause();\n    this.router.navigate(path);\n    this.router.resume();\n  }\n\n  /**\n   * Non-selected Site\n   */\n  _entryRoute() {\n    this._updateLocation('/');\n    this.fire('route-entry');\n  }\n\n  /**\n   * Selected Site, View Layout\n   */\n  _viewSite(params) {\n    if (params['Site_Code']) {\n      this._updateLocation('/view/' + params['Site_Code']);\n      this.fire('route-view', params);\n    } else {\n      console.error('bad viewSite call');\n    }\n  }\n\n  /**\n   * Selected Site, Print Layout\n   */\n  _printSite(params) {\n    if (params['Site_Code']) {\n      this._updateLocation('/print/' + params['Site_Code']);\n      this.fire('route-print', params);\n    } else {\n      console.error('bad printSite call');\n    }\n  }\n\n  /**\n   * clear selection\n   */\n  clearRoute() {\n    this.setRoute();\n  }\n\n  setRoute(name, params) {\n    if (arguments.length > 0 && this.route[name]) {\n      this.route[name].handler(params);\n    } else {\n      this._entryRoute();\n    }\n  }\n\n}"],"names":["colorRange","RestylingCircleMarker","L","CircleMarker","extend","getEvents","zoomend","this","_restyle","normalpoints","_normal","typepoints","_orifice","condpoints","_conductivity","qpoints","_discharge","e","setRadius","a","Math","max","calcRadius","target","getZoom","_activeBackup","setStyle","color","feature","properties","Orifice_Geom","length","binWidth","aggrData","aggr","min","i","highlight","options","removeHighlight","SiteData","[object Object]","springs","springPhotos","springSketches","_springPhotos","_springSketches","_aggrKeys","_gatherAggrData","site","Promise","resolve","reject","query","where","run","err","col","photos","features","map","value","sort","b","Image_Number","sketches","index","layer","aggrKeys","data","eachFeature","obj","l","result","forEach","key","push","window","siteMap","Evented","super","selected","zoomControl","setView","el","document","querySelector","Control","Zoom","position","addTo","osmhot","tileLayer","attribution","label","esrisat","maxZoom","esri","basemapLayer","basemaps","addControl","control","tileX","tileY","tileZ","featureLayer","url","pointToLayer","geoJsonPoint","latlon","weight","radius","once","fire","bind","on","_highlight","propagatedFrom","point","getPoint","setZoomAround","getLatLng","bringToFront","clearSelection","getHighlightPoint","setHighlightPoint","bringToBack","isVisible","removeAttribute","invalidateSize","setAttribute","sidebar","siteData","deselectFeature","dispatchEvent","CustomEvent","bubbles","detail","closed","querySelectorAll","details","sketch","selectFeature","info","all","lookupPhotos","catch","lookupSketches","then","resolved","router","Navigo","location","origin","Object","entries","route","signature","handler","notFound","entry","_entryRoute","view","_viewSite","print","_printSite","path","pause","navigate","resume","_updateLocation","params","console","error","setRoute","name","arguments","switchTab","setVisibility","attr","selectPoint","clearRoute","addEventListener","type"],"mappings":"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"}